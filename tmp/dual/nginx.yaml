---
apiVersion: v1
kind: Pod
metadata:
  name: sample-nginx
  labels:
    app: sample-nginx
spec:
  hostname: sample-nginx
  subdomain: sample-nginx-peer
  containers:
  - image: traefik/whoami
    imagePullPolicy: IfNotPresent
    name: nginx
    ports:
    - name: http
      containerPort: 8080
    command:
      - "/whoami"
      - "--port=8080"
    securityContext:
      allowPrivilegeEscalation: false
      capabilities:
        drop:
        - ALL
      runAsNonRoot: true
      seccompProfile:
        type: RuntimeDefault
  restartPolicy: Always
---
apiVersion: v1
kind: Service
metadata:
  name: sample-nginx-peer
spec:
  ports:
  - port: 8080
  selector:
    app: sample-nginx
  clusterIP: None # address the pods directly
